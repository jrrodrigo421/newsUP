{% extends "base.html" %} {% block title %}Seu Feed de Notu00edcias{% endblock %} {% block} {% block
content %}
<div class="news-feed-container">
  <div class="feed-header">
    <h1 class="page-title">Seu <span class="highlight">Feed de Notu00edcias</span></h1>span></h1>
    <div class="feed-controls">
      <div class="topic-filters">
        <span class="filter-label">Filtrar por:</span>n>
        <div class="filter-buttons">
          <button class="filter-btn active" data-filter="all">Todos</button>n>
          {% for topic in topics %}
          <button class="filter-btn" data-filter="{{ topic }}">
            {% if topic == 'tecnologia' %}Tecnologia
            {% elif topic == 'negocios' %}Negu00f3cios
            {% elif topic == 'ciencia' %}Ciu00eancia
            {% elif topic == 'saude' %}Sau00fade
            {% elif topic == 'entretenimento' %}Entretenimento
            {% else %}{{ topic|capitalize }}
            {% endif %}ogia' %}Tecnologia
            {% elif topic == 'negocios' %}Negu00f3cios
            {% elif topic == 'ciencia' %}Ciu00eancia
            {% elif topic == 'saude' %}Sau00fade
            {% elif topic == 'entretenimento' %}Entretenimento
      <button id="refresh-btn" class="btn btn-icon" title="Atualizar Feed">
            {% endif %}
          </button>
          {% endfor %}
        </div>
      </div>
      <button id="refresh-btn" class="btn btn-icon" title="Atualizar Feed">
        <span class="material-icons">refresh</span>
      </button>
    </div>
  </div>
        <span class="article-category">
          {% if article.category == 'tecnologia' %}Tecnologia
          {% elif article.category == 'negocios' %}Negu00f3cios
          {% elif article.category == 'ciencia' %}Ciu00eancia
          {% elif article.category == 'saude' %}Sau00fade
          {% elif article.category == 'entretenimento' %}Entretenimento
          {% else %}{{ article.category|capitalize }}
          {% endif %}
        </span>
  <div class="articles-grid">
    {% if articles %} {% for article in articles %}
    <article class="article-card" data-category="{{ article.category }}">
          <a href="{{ url_for('detalhe_artigo', artigo_id=loop.index0) }}"
        <img src="{{ article.image_url }}" alt="{{ article.title }}" />
        <span class="article-category">
          {% if article.category == 'tecnologia' %}Tecnologia
          {% elif article.category == 'negocios' %}Negu00f3cios
          {% elif article.category == 'ciencia' %}Ciu00eancia
          {% elif article.category == 'saude' %}Sau00fade
          {% elif article.category == 'entretenimento' %}Entretenimento
          {% else %}{{ article.category|capitalize }}
          {% endif %}
        </span>
      </div>
      <div class="article-content">
            href="{{ url_for('detalhe_artigo', artigo_id=loop.index0) }}"
          <a href="{{ url_for('detalhe_artigo', artigo_id=loop.index0) }}"
            >Ler Mais</aitle }}</a
          >
        </h2>
        <p class="article-description">
            action="{{ url_for('salvar_artigo', artigo_id=loop.index0) }}"
        </p>
        <div class="article-meta">
          <span class="article-source">{{ article.source }}</span>
            <button type="submit" class="btn btn-icon" title="Salvar Artigo">
        </div>
        <div class="article-actions">
          <a
            href="{{ url_for('detalhe_artigo', artigo_id=loop.index0) }}"
            class="btn btn-text"
            >Ler Mais</
          >
          <form
            method="POST"
      <h2>Nenhum artigo encontrado</h2>salvar_artigo', artigo_id=loop.index0) }}"
            class="inline-form"
        Tente selecionar diferentes tu00f3picos nas suas preferu00eancias ou volte mais tarde
        para novo conteu00fado."hidden" name="csrf_token" value="{{ csrf_token() }}" />
            <button type="submit" class="btn btn-icon" title="Salvar Artigo">
      <a href="{{ url_for('configurar') }}" class="btn btn-primary"
        >Atualizar Preferu00eancias</a
          </form>
        </div>
      </div>
    </article>
    {% endfor %} {% else %}
    <div class="empty-state">
      <span class="material-icons empty-icon">article</span>
    <p>Buscando conteu00fado novo...</p>h2>
      <p>
        Tente selecionar diferentes tu00f3picos nas suas preferu00eancias ou volte mais tarde
        para novo conteu00fado.
      </p>
      <a href="{{ url_for('configurar') }}" class="btn btn-primary"
    // Funcionalidade de filtro0eancias</a
      >
    </div>
    {% endif %}
  </div>

  <div class="loading-indicator hidden">
    <div class="spinner"></div>
        // Atualiza botu00e3o ativovo...</p>
  </div>
</div>
{% endblock %} {% block extra_js %}
        // Filtra artigos
  document.addEventListener('DOMContentLoaded', function () {
    // Funcionalidade de filtro
    const filterButtons = document.querySelectorAll('.filter-btn');
    const articleCards = document.querySelectorAll('.article-card');

    filterButtons.forEach(button => {
      button.addEventListener('click', function () {
        const filter = this.getAttribute('data-filter');

        // Atualiza botu00e3o ativo
        filterButtons.forEach(btn => btn.classList.remove('active'));
        this.classList.add('active');

    // Funcionalidade de atualizau00e7u00e3o
        articleCards.forEach(card => {
          if (
            filter === 'all' ||
            card.getAttribute('data-category') === filter
      // Mostra indicador de carregamento
            card.style.display = 'flex';
          } else {
      // Faz requisiu00e7u00e3o AJAX para atualizar notu00edcias
      fetch('{{ url_for("atualizar_noticias") }}', {
        });
      });
    });

    // Funcionalidade de atualizau00e7u00e3o
    const refreshBtn = document.getElementById('refresh-btn');
    const loadingIndicator = document.querySelector('.loading-indicator');

          if (data.sucesso) {
            // Recarrega a pu00e1gina para mostrar novo conteu00fado
      loadingIndicator.classList.remove('hidden');

            alert('Erro ao atualizar notu00edcias: ' + data.erro);edcias
      fetch('{{ url_for("atualizar_noticias") }}', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          console.error('Erro:', error);
          alert('Ocorreu um erro ao atualizar as notu00edcias.');
      })
        .then(response => response.json())
        .then(data => {
          if (data.sucesso) {
            // Recarrega a pu00e1gina para mostrar novo conteu00fado
            window.location.reload();
          } else {
            alert('Erro ao atualizar notu00edcias: ' + data.erro);
            loadingIndicator.classList.add('hidden');
          }
        })
        .catch(error => {
          console.error('Erro:', error);
          alert('Ocorreu um erro ao atualizar as notu00edcias.');
          loadingIndicator.classList.add('hidden');
        });
    });
  });
</script>
{% endblock %}